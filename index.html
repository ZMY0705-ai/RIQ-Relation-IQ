<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RelationIQ - å…³ç³»è¯„ä¼°ç³»ç»Ÿ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#9A8C98',
                        secondary: '#C9ADA7',
                        accent: '#4A4E69',
                        background: '#F2E9E4',
                        text: '#22223B',
                        success: '#A7C4A0',
                        warning: '#E6B89C',
                        danger: '#D4A5A5'
                    }
                }
            }
        }
    </script>
    <style>
        .sidebar {
            width: 250px;
            transition: all 0.3s;
            background-color: #4A4E69;
        }
        .main-content {
            margin-left: 250px;
            transition: all 0.3s;
            background-color: #F2E9E4;
        }
        .collapsed .sidebar {
            width: 70px;
        }
        .collapsed .main-content {
            margin-left: 70px;
        }
        .drawer {
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }
        .drawer.open {
            transform: translateX(0);
        }
        .profile-card {
            transition: all 0.2s ease;
            background-color: white;
        }
        .profile-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .risk-high {
            background-color: #FADBD8;
            color: #C0392B;
        }
        .risk-medium {
            background-color: #FCF3CF;
            color: #D68910;
        }
        .risk-low {
            background-color: #D5F5E3;
            color: #239B56;
        }
        .page {
            display: none;
        }
        .page.active {
            display: block;
        }
        .star-rating button {
            font-size: 1.2rem;
            transition: color 0.2s;
        }
        .star-rating button.active {
            color: #F39C12;
        }
        .criteria-item {
            transition: all 0.2s;
        }
        .criteria-item:hover {
            background-color: #f9fafb;
        }
        .radar-chart-container {
            height: 250px;
        }
        .nav-item.active {
            background-color: rgba(255, 255, 255, 0.1);
            border-right: 3px solid #9A8C98;
        }
        .card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        .btn-primary {
            background-color: #9A8C98;
            color: white;
        }
        .btn-primary:hover {
            background-color: #8A7C88;
        }
        .btn-secondary {
            background-color: #C9ADA7;
            color: white;
        }
        .btn-secondary:hover {
            background-color: #B99D97;
        }
        .section-title {
            color: #4A4E69;
            border-left: 4px solid #9A8C98;
            padding-left: 12px;
        }
        .sub-criteria {
            margin-left: 20px;
            border-left: 2px solid #E2E8F0;
            padding-left: 15px;
        }
        .dragging {
            opacity: 0.6;
        }
        .delete-btn {
            transition: all 0.2s;
        }
        .delete-btn:hover {
            background-color: #EF4444;
            color: white;
        }
    </style>
</head>
<body class="bg-background text-text">
    <!-- åº”ç”¨å®¹å™¨ -->
    <div class="app-container min-h-screen flex">
        <!-- ä¾§è¾¹æ å¯¼èˆª -->
        <div class="sidebar text-white fixed h-full overflow-y-auto z-10">
            <div class="p-4 border-b border-gray-600">
                <div class="flex items-center justify-between">
                    <h1 class="text-xl font-bold">RelationIQ</h1>
                    <button class="toggle-sidebar p-1 rounded hover:bg-gray-700 text-white">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
            
            <nav class="mt-6">
                <a href="#" class="nav-item active flex items-center px-4 py-3 text-white hover:bg-gray-700" data-page="profiles">
                    <i class="fas fa-users w-6 text-center mr-3"></i>
                    <span class="nav-text">å¯¹è±¡åº“</span>
                </a>
                <a href="#" class="nav-item flex items-center px-4 py-3 text-white hover:bg-gray-700" data-page="personal">
                    <i class="fas fa-user w-6 text-center mr-3"></i>
                    <span class="nav-text">ä¸ªäººä¸­å¿ƒ</span>
                </a>
            </nav>
            
            <div class="mt-8 px-4">
                <h3 class="text-xs font-semibold text-gray-300 uppercase tracking-wide mb-2">å¿«æ·æ“ä½œ</h3>
                <button class="w-full bg-secondary text-white py-2 rounded-md text-sm font-medium flex items-center justify-center mb-2">
                    <i class="fas fa-download mr-2"></i> å¯¼å‡ºæ•°æ®
                </button>
                <button class="w-full bg-gray-700 text-white py-2 rounded-md text-sm font-medium flex items-center justify-center">
                    <i class="fas fa-upload mr-2"></i> å¯¼å…¥æ•°æ®
                </button>
            </div>
        </div>
        
        <!-- ä¸»å†…å®¹åŒº -->
        <div class="main-content flex-1 p-6">
            <!-- å¯¹è±¡åº“é¡µé¢ -->
            <div id="profiles-page" class="page active">
                <div class="flex justify-between items-center mb-6">
                    <h1 class="text-2xl font-bold">å¯¹è±¡åº“</h1>
                    <div class="flex space-x-2">
                        <div class="relative">
                            <input type="text" placeholder="æœç´¢å¯¹è±¡..." class="pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary">
                            <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                        </div>
                        <select id="sort-profiles" class="border border-gray-300 rounded-md focus:ring-primary focus:border-primary py-2 px-3">
                            <option value="score-desc">æŒ‰å¾—åˆ†ä»é«˜åˆ°ä½</option>
                            <option value="score-asc">æŒ‰å¾—åˆ†ä»ä½åˆ°é«˜</option>
                            <option value="date-desc">æŒ‰æ·»åŠ æ—¶é—´ä»æ–°åˆ°æ—§</option>
                            <option value="date-asc">æŒ‰æ·»åŠ æ—¶é—´ä»æ—§åˆ°æ–°</option>
                            <option value="custom">è‡ªå®šä¹‰æ’åº</option>
                        </select>
                        <button class="btn-primary px-4 py-2 rounded-md flex items-center" id="add-profile-btn">
                            <i class="fas fa-plus mr-2"></i> æ–°å»ºå¯¹è±¡
                        </button>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="profiles-container">
                    <!-- å¯¹è±¡å¡ç‰‡å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
                
                <!-- ç©ºçŠ¶æ€ -->
                <div id="empty-state" class="text-center py-12">
                    <div class="w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-user-plus text-gray-500 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-medium mb-2">æš‚æ— è¯„ä¼°å¯¹è±¡</h3>
                    <p class="text-gray-600 mb-6">ç‚¹å‡»"æ–°å»ºå¯¹è±¡"æŒ‰é’®æ·»åŠ ç¬¬ä¸€ä¸ªè¯„ä¼°å¯¹è±¡</p>
                    <button class="btn-primary px-4 py-2 rounded-md font-medium" id="empty-add-btn">
                        <i class="fas fa-plus mr-2"></i> æ–°å»ºå¯¹è±¡
                    </button>
                </div>
            </div>
            
            <!-- ä¸ªäººä¸­å¿ƒé¡µé¢ -->
            <div id="personal-page" class="page">
                <div class="max-w-4xl mx-auto">
                    <h1 class="text-2xl font-bold mb-6">ä¸ªäººä¸­å¿ƒ</h1>
                    
                    <div class="space-y-6">
                        <!-- åŸºæœ¬ä¿¡æ¯ -->
                        <div class="card p-6">
                            <h2 class="section-title text-lg font-semibold mb-4">
                                <i class="fas fa-id-card text-primary mr-2"></i>
                                åŸºæœ¬ä¿¡æ¯
                            </h2>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium mb-1">å§“å</label>
                                    <input type="text" class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" placeholder="æ‚¨çš„å§“å" id="personal-name">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1">å¹´é¾„</label>
                                    <input type="number" class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" placeholder="å¹´é¾„" id="personal-age">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium mb-1">ç†æƒ³ä¼´ä¾£æè¿°</label>
                                    <textarea class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" rows="3" placeholder="æè¿°æ‚¨ç†æƒ³ä¸­çš„ä¼´ä¾£..." id="personal-ideal"></textarea>
                                </div>
                            </div>
                            
                            <button class="mt-4 btn-primary px-4 py-2 rounded-md text-sm font-medium" id="save-personal-info">
                                <i class="fas fa-save mr-1"></i> ä¿å­˜åŸºæœ¬ä¿¡æ¯
                            </button>
                        </div>
                        
                        <!-- è‡ªæˆ‘è¯„ä¼° -->
                        <div class="card p-6">
                            <h2 class="section-title text-lg font-semibold mb-4">
                                <i class="fas fa-chart-line text-primary mr-2"></i>
                                è‡ªæˆ‘è¯„ä¼°
                            </h2>
                            
                            <div class="mb-6">
                                <h3 class="font-medium mb-2">æ‹©å¶ä¼˜åŠ¿ä¸åŠ£åŠ¿</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium mb-1">æˆ‘çš„ä¼˜åŠ¿</label>
                                        <textarea class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" rows="3" placeholder="åˆ—å‡ºæ‚¨åœ¨å…³ç³»ä¸­çš„ä¼˜åŠ¿..." id="self-advantages"></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-1">æˆ‘çš„åŠ£åŠ¿</label>
                                        <textarea class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" rows="3" placeholder="åˆ—å‡ºæ‚¨éœ€è¦æ”¹è¿›çš„æ–¹é¢..." id="self-disadvantages"></textarea>
                                    </div>
                                </div>
                                <button class="mt-2 btn-secondary px-4 py-2 rounded-md text-sm font-medium" id="save-self-assessment">
                                    <i class="fas fa-save mr-1"></i> ä¿å­˜è‡ªæˆ‘è¯„ä¼°
                                </button>
                            </div>
                            
                            <div>
                                <h3 class="font-medium mb-2">ä¸ªäººç‰¹è´¨è¯„ä¼°</h3>
                                <div class="space-y-4" id="self-assessment-criteria">
                                    <!-- è‡ªæˆ‘è¯„ä¼°æ ‡å‡†å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                                </div>
                                
                                <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                                    <div class="flex justify-between items-center mb-4">
                                        <span class="font-medium">è‡ªæˆ‘è¯„ä¼°æ€»åˆ†</span>
                                        <span class="text-xl font-bold text-primary" id="self-weighted-score">0</span>
                                    </div>
                                    <div class="radar-chart-container">
                                        <canvas id="self-radar-chart"></canvas>
                                    </div>
                                    <div class="mt-4 grid grid-cols-2 gap-2 text-xs" id="self-radar-legend">
                                        <!-- é›·è¾¾å›¾å›¾ä¾‹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- è¯„ä¼°æ ‡å‡† -->
                        <div class="card p-6">
                            <h2 class="section-title text-lg font-semibold mb-4">
                                <i class="fas fa-list-check text-primary mr-2"></i>
                                è¯„ä¼°æ ‡å‡†
                            </h2>
                            
                            <div class="space-y-6" id="assessment-criteria">
                                <!-- è¯„ä¼°æ ‡å‡†å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                            </div>
                            
                            <button class="mt-4 btn-primary px-4 py-2 rounded-md text-sm font-medium" id="add-category-btn">
                                <i class="fas fa-plus mr-1"></i> æ·»åŠ è¯„ä¼°å¤§ç±»
                            </button>
                        </div>
                        
                        <!-- åŸåˆ™ç³»ç»Ÿ -->
                        <div class="card p-6">
                            <h2 class="section-title text-lg font-semibold mb-4">
                                <i class="fas fa-balance-scale text-primary mr-2"></i>
                                åŸåˆ™ç³»ç»Ÿ
                            </h2>
                            
                            <div class="space-y-4">
                                <div>
                                    <h3 class="font-medium text-danger mb-2">ğŸš« çº¢çº¿æ¸…å•</h3>
                                    <div class="space-y-2" id="red-lines">
                                        <!-- çº¢çº¿å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                                    </div>
                                    <button class="add-item-btn text-sm text-danger mt-2 flex items-center" data-type="red-line">
                                        <i class="fas fa-plus mr-1"></i> æ·»åŠ çº¢çº¿
                                    </button>
                                </div>
                                
                                <div>
                                    <h3 class="font-medium text-accent mb-2">ğŸ“‹ æ‹çˆ±å‡†åˆ™</h3>
                                    <div class="space-y-2" id="relationship-guidelines">
                                        <!-- å‡†åˆ™å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                                    </div>
                                    <button class="add-item-btn text-sm text-accent mt-2 flex items-center" data-type="guideline">
                                        <i class="fas fa-plus mr-1"></i> æ·»åŠ å‡†åˆ™
                                    </button>
                                </div>
                                
                                <div>
                                    <h3 class="font-medium text-success mb-2">âš–ï¸ éåå•†æ¡æ¬¾</h3>
                                    <div class="space-y-2" id="non-negotiables">
                                        <!-- éåå•†æ¡æ¬¾å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                                    </div>
                                    <button class="add-item-btn text-sm text-success mt-2 flex items-center" data-type="non-negotiable">
                                        <i class="fas fa-plus mr-1"></i> æ·»åŠ æ¡æ¬¾
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æ¡£æ¡ˆæŠ½å±‰ -->
        <div class="drawer fixed inset-y-0 right-0 w-full max-w-2xl bg-white shadow-xl z-20 overflow-y-auto">
            <div class="p-4 border-b border-gray-200 sticky top-0 bg-white">
                <div class="flex justify-between items-center">
                    <h2 class="text-lg font-semibold" id="drawer-title">æ–°å»ºè¯„ä¼°å¯¹è±¡</h2>
                    <button class="close-drawer p-2 rounded-full hover:bg-gray-100">
                        <i class="fas fa-times text-gray-500"></i>
                    </button>
                </div>
                
                <!-- æ ‡ç­¾å¯¼èˆª -->
                <div class="tabs flex mt-4 border-b border-gray-200 overflow-x-auto">
                    <button class="tab-btn py-2 px-4 font-medium text-sm border-b-2 border-primary text-primary whitespace-nowrap" data-tab="basic">
                        åŸºç¡€ä¿¡æ¯
                    </button>
                    <button class="tab-btn py-2 px-4 font-medium text-sm text-gray-500 hover:text-gray-700 whitespace-nowrap" data-tab="assessment">
                        å…³ç³»è¯„ä¼°
                    </button>
                    <button class="tab-btn py-2 px-4 font-medium text-sm text-gray-500 hover:text-gray-700 whitespace-nowrap" data-tab="interaction">
                        äº’åŠ¨è®°å½•
                    </button>
                    <button class="tab-btn py-2 px-4 font-medium text-sm text-gray-500 hover:text-gray-700 whitespace-nowrap" data-tab="evaluation">
                        ç»¼åˆè¯„ä¼°
                    </button>
                </div>
            </div>
            
            <!-- æ ‡ç­¾å†…å®¹ -->
            <div class="p-4">
                <!-- åŸºç¡€ä¿¡æ¯æ ‡ç­¾é¡µ -->
                <div id="tab-basic" class="tab-content active">
                    <form id="basic-info-form">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium mb-1">å§“å</label>
                                <input type="text" id="profile-name" class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" placeholder="è¾“å…¥å§“å" required>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium mb-1">å¹´é¾„</label>
                                    <input type="number" id="profile-age" class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" placeholder="å¹´é¾„">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1">èŒä¸š</label>
                                    <input type="text" id="profile-occupation" class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" placeholder="èŒä¸š">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium mb-1">ç›¸é‡èƒŒæ™¯</label>
                                <textarea id="profile-meeting" class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" rows="3" placeholder="æè¿°å¦‚ä½•è®¤è¯†çš„ï¼Œç¬¬ä¸€å°è±¡ç­‰"></textarea>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium mb-1">è”ç³»æ–¹å¼</label>
                                <input type="text" id="profile-contact" class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" placeholder="ç”µè¯/å¾®ä¿¡ç­‰">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium mb-1">å…³ç³»ç±»å‹</label>
                                <div class="flex space-x-4">
                                    <label class="flex items-center">
                                        <input type="radio" name="relationship-type" value="short-term" class="mr-2">
                                        <span>çŸ­æœŸå…³ç³»</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="relationship-type" value="long-term" class="mr-2" checked>
                                        <span>é•¿æœŸå‘å±•</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                
                <!-- å…³ç³»è¯„ä¼°æ ‡ç­¾é¡µ -->
                <div id="tab-assessment" class="tab-content">
                    <div class="space-y-6">
                        <!-- æ€»åˆ†å’Œé›·è¾¾å›¾åŒºåŸŸ -->
                        <div class="card p-4">
                            <div class="flex justify-between items-center mb-4">
                                <span class="font-medium text-lg">ç»¼åˆè¯„åˆ†</span>
                                <span class="text-2xl font-bold text-primary" id="weighted-score">0</span>
                            </div>
                            <div class="radar-chart-container">
                                <canvas id="radar-chart"></canvas>
                            </div>
                            <div class="mt-4 grid grid-cols-2 gap-2 text-xs" id="radar-legend">
                                <!-- é›·è¾¾å›¾å›¾ä¾‹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                            </div>
                        </div>
                        
                        <!-- å„é¡¹å¾—åˆ†è¯¦æƒ… -->
                        <div id="assessment-criteria-container">
                            <!-- è¯„ä¼°æ ‡å‡†å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
                
                <!-- äº’åŠ¨è®°å½•æ ‡ç­¾é¡µ -->
                <div id="tab-interaction" class="tab-content">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-md font-medium">äº’åŠ¨è®°å½•</h3>
                        <button class="btn-primary px-3 py-1 rounded-md text-sm flex items-center" id="add-interaction-btn">
                            <i class="fas fa-plus mr-1"></i> æ·»åŠ è®°å½•
                        </button>
                    </div>
                    
                    <div class="space-y-4" id="interaction-list">
                        <!-- äº’åŠ¨è®°å½•å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
                
                <!-- ç»¼åˆè¯„ä¼°æ ‡ç­¾é¡µ -->
                <div id="tab-evaluation" class="tab-content">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-1">æ ¸å¿ƒä¼˜åŠ¿</label>
                            <textarea id="evaluation-strengths" class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" rows="3" placeholder="åˆ—å‡ºå¯¹æ–¹çš„3-5ä¸ªæ ¸å¿ƒä¼˜åŠ¿"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-1">ä¸»è¦ç¼ºç‚¹</label>
                            <textarea id="evaluation-weaknesses" class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" rows="2" placeholder="åˆ—å‡º1-3ä¸ªä¸»è¦ç¼ºç‚¹"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-1">å¸å¼•åŠ›åˆ†æ</label>
                            <textarea id="evaluation-attractions" class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" rows="2" placeholder="åˆ†æå¯¹æ–¹å¸å¼•ä½ çš„æ ¸å¿ƒç‰¹è´¨"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-1">æ½œåœ¨é£é™©</label>
                            <textarea id="evaluation-risks" class="w-full p-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" rows="2" placeholder="è¯†åˆ«å…³ç³»ä¸­å¯èƒ½å­˜åœ¨çš„é£é™©"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
            <div class="p-4 border-t border-gray-200 sticky bottom-0 bg-white">
                <button id="save-profile" class="w-full btn-primary py-2 rounded-md font-medium">
                    ä¿å­˜æ¡£æ¡ˆ
                </button>
            </div>
        </div>
    </div>

    <script>
        // åº”ç”¨çŠ¶æ€
        let appState = {
            profiles: [],
            personalInfo: {
                name: '',
                age: '',
                ideal: '',
                selfAssessment: {
                    advantages: '',
                    disadvantages: '',
                    criteriaScores: []
                },
                categories: [
                    {
                        id: 'communication',
                        name: 'æ²Ÿé€šèƒ½åŠ›',
                        weight: 30,
                        criteria: [
                            { id: 'communication-initiative', name: 'æ²Ÿé€šç§¯ææ€§', description: 'ä¸»åŠ¨å‘èµ·å¯¹è¯ã€å›åº”åŠæ—¶æ€§', weight: 5 },
                            { id: 'listening-skills', name: 'å€¾å¬ç†è§£èƒ½åŠ›', description: 'æ˜¯å¦ä¸“æ³¨å€¾å¬ã€èƒ½å¦ç†è§£ä½ çš„æ„Ÿå—', weight: 5 },
                            { id: 'emotional-stability', name: 'æƒ…ç»ªç¨³å®šæ€§', description: 'æƒ…ç»ªæ³¢åŠ¨é¢‘ç‡ã€æŠ—å‹èƒ½åŠ›', weight: 5 }
                        ]
                    },
                    {
                        id: 'values',
                        name: 'ä»·å€¼è§‚ä¸å“è´¨',
                        weight: 40,
                        criteria: [
                            { id: 'honesty', name: 'è¯šå®é€æ˜', description: 'ä¿¡æ¯çœŸå®æ€§ã€å¦è¯šæ²Ÿé€šæ„æ„¿', weight: 5 },
                            { id: 'respect-boundaries', name: 'è¾¹ç•Œå°Šé‡', description: 'å°Šé‡ä¸ªäººç©ºé—´ã€ç†è§£éœ€æ±‚', weight: 5 },
                            { id: 'responsibility', name: 'è´£ä»»æ„Ÿ', description: 'æ‰¿è¯ºå±¥è¡Œã€é—®é¢˜è§£å†³ä¸»åŠ¨æ€§', weight: 5 }
                        ]
                    },
                    {
                        id: 'relationship',
                        name: 'å…³ç³»å¤„ç†',
                        weight: 30,
                        criteria: [
                            { id: 'cold-violence-tendency', name: 'å†·æš´åŠ›å€¾å‘', description: 'å†²çªåå¤„ç†æ–¹å¼ã€æ²‰é»˜æŒç»­æ—¶é—´', weight: 5, isCritical: true },
                            { id: 'hot-cold-pattern', name: 'å¿½å†·å¿½çƒ­æ¨¡å¼', description: 'çƒ­æƒ…ä¸å†·æ·¡çš„åˆ‡æ¢é¢‘ç‡', weight: 5 },
                            { id: 'conflict-resolution', name: 'å†²çªè§£å†³æ¨¡å¼', description: 'äº‰åµæ—¶çš„è¡¨ç°ã€è§£å†³é—®é¢˜çš„æ–¹å¼', weight: 5 }
                        ]
                    }
                ],
                redLines: ['å†·æš´åŠ›', 'æ¬ºéª—', 'ä¸å°Šé‡è¾¹ç•Œ'],
                guidelines: ['å®šæœŸæ·±åº¦æ²Ÿé€š', 'åµæ¶ä¸è¿‡å¤œ', 'ä¿æŒä¸ªäººç©ºé—´'],
                nonNegotiables: ['æƒ…ç»ªç¨³å®š', 'è¯šå®é€æ˜', 'ä»·å€¼è§‚ä¸€è‡´']
            },
            currentProfile: null,
            sortOrder: 'score-desc'
        };

        // DOM å…ƒç´ 
        const appContainer = document.querySelector('.app-container');
        const toggleSidebarBtn = document.querySelector('.toggle-sidebar');
        const navItems = document.querySelectorAll('.nav-item');
        const pages = document.querySelectorAll('.page');
        const drawer = document.querySelector('.drawer');
        const closeDrawerBtn = document.querySelector('.close-drawer');
        const addProfileBtns = document.querySelectorAll('#add-profile-btn, #empty-add-btn');
        const profilesContainer = document.getElementById('profiles-container');
        const emptyState = document.getElementById('empty-state');
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');
        const saveProfileBtn = document.getElementById('save-profile');
        const addInteractionBtn = document.getElementById('add-interaction-btn');
        const interactionList = document.getElementById('interaction-list');
        const radarChartCanvas = document.getElementById('radar-chart');
        const selfRadarChartCanvas = document.getElementById('self-radar-chart');
        const assessmentCriteriaContainer = document.getElementById('assessment-criteria-container');
        const personalCriteriaContainer = document.getElementById('assessment-criteria');
        const selfAssessmentContainer = document.getElementById('self-assessment-criteria');
        const addCategoryBtn = document.getElementById('add-category-btn');
        const savePersonalInfoBtn = document.getElementById('save-personal-info');
        const saveSelfAssessmentBtn = document.getElementById('save-self-assessment');
        const addItemBtns = document.querySelectorAll('.add-item-btn');
        const sortProfilesSelect = document.getElementById('sort-profiles');

        // åˆå§‹åŒ–
        function init() {
            loadData();
            renderProfiles();
            setupEventListeners();
            renderPersonalCategories();
            renderSelfAssessment();
            renderPersonalPrinciples();
            updateEmptyState();
        }

        // ä»localStorageåŠ è½½æ•°æ®
        function loadData() {
            const savedProfiles = localStorage.getItem('relationiq-profiles');
            const savedPersonalInfo = localStorage.getItem('relationiq-personal');
            const savedSortOrder = localStorage.getItem('relationiq-sort');
            
            if (savedProfiles) {
                appState.profiles = JSON.parse(savedProfiles);
            }
            
            if (savedPersonalInfo) {
                appState.personalInfo = { ...appState.personalInfo, ...JSON.parse(savedPersonalInfo) };
                // æ›´æ–°ä¸ªäººä¸­å¿ƒè¡¨å•
                document.getElementById('personal-name').value = appState.personalInfo.name || '';
                document.getElementById('personal-age').value = appState.personalInfo.age || '';
                document.getElementById('personal-ideal').value = appState.personalInfo.ideal || '';
                document.getElementById('self-advantages').value = appState.personalInfo.selfAssessment.advantages || '';
                document.getElementById('self-disadvantages').value = appState.personalInfo.selfAssessment.disadvantages || '';
            }
            
            if (savedSortOrder) {
                appState.sortOrder = savedSortOrder;
                sortProfilesSelect.value = savedSortOrder;
            }
        }

        // ä¿å­˜æ•°æ®åˆ°localStorage
        function saveData() {
            localStorage.setItem('relationiq-profiles', JSON.stringify(appState.profiles));
            localStorage.setItem('relationiq-personal', JSON.stringify(appState.personalInfo));
            localStorage.setItem('relationiq-sort', appState.sortOrder);
        }

        // æ¸²æŸ“å¯¹è±¡å¡ç‰‡
        function renderProfiles() {
            profilesContainer.innerHTML = '';
            
            if (appState.profiles.length === 0) {
                return;
            }
            
            // æ ¹æ®æ’åºæ–¹å¼å¯¹å¯¹è±¡è¿›è¡Œæ’åº
            const sortedProfiles = [...appState.profiles];
            
            switch(appState.sortOrder) {
                case 'score-desc':
                    sortedProfiles.sort((a, b) => (b.assessment?.weightedScore || 0) - (a.assessment?.weightedScore || 0));
                    break;
                case 'score-asc':
                    sortedProfiles.sort((a, b) => (a.assessment?.weightedScore || 0) - (b.assessment?.weightedScore || 0));
                    break;
                case 'date-desc':
                    sortedProfiles.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                    break;
                case 'date-asc':
                    sortedProfiles.sort((a, b) => new Date(a.createdAt) - new Date(b.createdAt));
                    break;
                case 'custom':
                    // ä¿æŒåŸé¡ºåº
                    break;
            }
            
            sortedProfiles.forEach(profile => {
                const card = document.createElement('div');
                card.className = 'profile-card rounded-lg border border-gray-200 p-4 cursor-pointer relative';
                card.setAttribute('data-id', profile.id);
                
                const timeAgo = getTimeAgo(profile.updatedAt);
                const riskLevel = calculateRiskLevel(profile);
                const riskClass = `risk-${riskLevel}`;
                const totalScore = profile.assessment?.weightedScore || 0;
                
                card.innerHTML = `
                    <!-- åˆ é™¤æŒ‰é’® -->
                    <button class="delete-profile absolute top-2 right-2 p-1 rounded-full bg-gray-100 text-gray-500 hover:bg-red-100 hover:text-red-500 transition-colors z-10" data-id="${profile.id}">
                        <i class="fas fa-times text-xs"></i>
                    </button>
                    
                    <div class="flex items-start">
                        <div class="w-12 h-12 bg-primary rounded-full flex items-center justify-center mr-3">
                            <span class="text-white font-semibold">${profile.name.charAt(0)}</span>
                        </div>
                        <div class="flex-1">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-medium">${profile.name}</h3>
                                    <span class="inline-block px-2 py-1 text-xs ${
                                        profile.relationshipType === 'long-term' 
                                            ? 'bg-primary text-white' 
                                            : 'bg-secondary text-white'
                                    } rounded-full mt-1">
                                        ${profile.relationshipType === 'long-term' 
                                            ? `é•¿æœŸå‘å±• Â· ${totalScore}åˆ†` 
                                            : `çŸ­æœŸå…³ç³»`}
                                    </span>
                                </div>
                                <span class="text-xs text-gray-500">${timeAgo}</span>
                            </div>
                            <p class="text-sm text-gray-600 mt-2">${
                                profile.evaluation?.strengths?.[0] || 'æš‚æ— è¯„ä¼°'
                            }</p>
                            <div class="flex justify-between items-center mt-3">
                                <span class="${riskClass} px-2 py-1 text-xs rounded-full">${
                                    riskLevel === 'high' ? 'é«˜é£é™©' : 
                                    riskLevel === 'medium' ? 'ä¸­é£é™©' : 'ä½é£é™©'
                                }</span>
                                <span class="text-xs text-gray-500">${profile.interactionLogs?.length || 0}æ¬¡äº’åŠ¨</span>
                            </div>
                        </div>
                    </div>
                `;
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶æ‰“å¼€æ¡£æ¡ˆ
                card.addEventListener('click', (e) => {
                    // å¦‚æœç‚¹å‡»çš„æ˜¯åˆ é™¤æŒ‰é’®ï¼Œåˆ™ä¸æ‰“å¼€æ¡£æ¡ˆ
                    if (!e.target.closest('.delete-profile')) {
                        openProfile(profile);
                    }
                });
                
                // æ·»åŠ åˆ é™¤äº‹ä»¶
                const deleteBtn = card.querySelector('.delete-profile');
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œé¿å…è§¦å‘å¡ç‰‡ç‚¹å‡»äº‹ä»¶
                    deleteProfile(profile.id);
                });
                
                profilesContainer.appendChild(card);
            });
        }

        // åˆ é™¤å¯¹è±¡
        function deleteProfile(profileId) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè¯„ä¼°å¯¹è±¡å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) {
                // ä»æ•°ç»„ä¸­ç§»é™¤å¯¹è±¡
                appState.profiles = appState.profiles.filter(profile => profile.id !== profileId);
                
                // ä¿å­˜æ•°æ®
                saveData();
                
                // é‡æ–°æ¸²æŸ“å¯¹è±¡åˆ—è¡¨
                renderProfiles();
                updateEmptyState();
                
                // å¦‚æœå½“å‰æ‰“å¼€çš„å¯¹è±¡è¢«åˆ é™¤ï¼Œåˆ™å…³é—­æŠ½å±‰
                if (appState.currentProfile && appState.currentProfile.id === profileId) {
                    closeDrawer();
                }
            }
        }

        // è®¡ç®—é£é™©ç­‰çº§
        function calculateRiskLevel(profile) {
            if (!profile.assessment || !profile.assessment.criteriaScores) {
                return 'low';
            }
            
            const totalScore = profile.assessment.weightedScore || 0;
            
            // æ£€æŸ¥æ˜¯å¦æœ‰å…³é”®æŒ‡æ ‡å¾—åˆ†ä½äº2åˆ†
            const hasCriticalLowScore = profile.assessment.criteriaScores.some(score => {
                const criterion = findCriterionById(score.id);
                return criterion && criterion.isCritical && score.score < 2;
            });
            
            // æ£€æŸ¥ä½åˆ†æŒ‡æ ‡æ•°é‡ï¼ˆ3åˆ†ä»¥ä¸‹ï¼‰
            const lowScoreCount = profile.assessment.criteriaScores.filter(score => score.score < 3).length;
            
            if (hasCriticalLowScore || totalScore < 60) {
                return 'high';
            } else if (lowScoreCount > 2 || totalScore < 75) {
                return 'medium';
            } else {
                return 'low';
            }
        }

        // æ ¹æ®IDæŸ¥æ‰¾è¯„ä¼°æ ‡å‡†
        function findCriterionById(id) {
            for (const category of appState.personalInfo.categories) {
                for (const criterion of category.criteria) {
                    if (criterion.id === id) {
                        return criterion;
                    }
                }
            }
            return null;
        }

        // æ‰“å¼€æ¡£æ¡ˆ
        function openProfile(profile) {
            appState.currentProfile = profile;
            
            // å¡«å……è¡¨å•æ•°æ®
            document.getElementById('profile-name').value = profile.name || '';
            document.getElementById('profile-age').value = profile.age || '';
            document.getElementById('profile-occupation').value = profile.occupation || '';
            document.getElementById('profile-meeting').value = profile.meetingContext || '';
            document.getElementById('profile-contact').value = profile.contact || '';
            
            // è®¾ç½®å…³ç³»ç±»å‹
            document.querySelector(`input[name="relationship-type"][value="${profile.relationshipType}"]`).checked = true;
            
            // è®¾ç½®è¯„ä¼°æ•°æ®
            renderAssessmentCriteria(profile);
            
            // è®¾ç½®ç»¼åˆè¯„ä¼°
            document.getElementById('evaluation-strengths').value = profile.evaluation?.strengths?.join('\n') || '';
            document.getElementById('evaluation-weaknesses').value = profile.evaluation?.weaknesses?.join('\n') || '';
            document.getElementById('evaluation-attractions').value = profile.evaluation?.attractions?.join('\n') || '';
            document.getElementById('evaluation-risks').value = profile.evaluation?.risks?.join('\n') || '';
            
            // è®¾ç½®äº’åŠ¨æ—¥å¿—
            renderInteractionLogs(profile.interactionLogs || []);
            
            // æ›´æ–°æŠ½å±‰æ ‡é¢˜
            document.getElementById('drawer-title').textContent = profile.name;
            
            // æ‰“å¼€æŠ½å±‰
            openDrawer();
        }

        // æ¸²æŸ“è¯„ä¼°æ ‡å‡†
        function renderAssessmentCriteria(profile = null) {
            assessmentCriteriaContainer.innerHTML = '';
            
            appState.personalInfo.categories.forEach(category => {
                const categoryElement = document.createElement('div');
                categoryElement.className = 'card p-4 mb-4';
                
                let categoryHTML = `
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-medium">${category.name}</h3>
                        <span class="text-sm text-gray-500">æƒé‡: ${category.weight}%</span>
                    </div>
                    <div class="sub-criteria">
                `;
                
                category.criteria.forEach(criterion => {
                    // è·å–è¯¥æ ‡å‡†çš„è¯„åˆ†æ•°æ®
                    const profileScore = profile?.assessment?.criteriaScores?.find(s => s.id === criterion.id);
                    
                    categoryHTML += `
                        <div class="criteria-item p-3 border border-gray-200 rounded-lg mb-3">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <span class="font-medium">${criterion.name}</span>
                                    <p class="text-xs text-gray-500 mt-1">${criterion.description}</p>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <select class="score-select text-sm border rounded p-1" data-criterion="${criterion.id}">
                                        <option value="0">æœªè¯„åˆ†</option>
                                        <option value="1" ${profileScore?.score === 1 ? 'selected' : ''}>1åˆ†</option>
                                        <option value="2" ${profileScore?.score === 2 ? 'selected' : ''}>2åˆ†</option>
                                        <option value="3" ${profileScore?.score === 3 ? 'selected' : ''}>3åˆ†</option>
                                        <option value="4" ${profileScore?.score === 4 ? 'selected' : ''}>4åˆ†</option>
                                        <option value="5" ${profileScore?.score === 5 ? 'selected' : ''}>5åˆ†</option>
                                    </select>
                                </div>
                            </div>
                            <textarea class="evidence-input w-full p-2 border border-gray-300 rounded-md text-sm" rows="2" 
                                      placeholder="è®°å½•å…·ä½“è¯æ®..." data-criterion="${criterion.id}">${profileScore?.evidence || ''}</textarea>
                        </div>
                    `;
                });
                
                categoryHTML += `</div>`;
                categoryElement.innerHTML = categoryHTML;
                assessmentCriteriaContainer.appendChild(categoryElement);
            });
            
            // æ·»åŠ è¯„åˆ†äº‹ä»¶ç›‘å¬
            document.querySelectorAll('.score-select').forEach(select => {
                select.addEventListener('change', updateWeightedScore);
            });
            
            document.querySelectorAll('.evidence-input').forEach(textarea => {
                textarea.addEventListener('input', updateWeightedScore);
            });
            
            // æ›´æ–°åŠ æƒåˆ†æ•°å’Œé›·è¾¾å›¾
            updateWeightedScore();
        }

        // æ›´æ–°åŠ æƒåˆ†æ•°
        function updateWeightedScore() {
            let totalScore = 0;
            let totalPossibleScore = 0;
            const criteriaScores = [];
            const criteriaNames = [];
            
            appState.personalInfo.categories.forEach(category => {
                const categoryWeight = category.weight / 100; // è½¬æ¢ä¸ºå°æ•°
                
                category.criteria.forEach(criterion => {
                    const scoreSelect = document.querySelector(`.score-select[data-criterion="${criterion.id}"]`);
                    const score = parseInt(scoreSelect.value) || 0;
                    
                    if (score > 0) {
                        // æ¯ä¸ªå°é¡¹åœ¨æ‰€å±å¤§ç±»ä¸­çš„æƒé‡æ¯”ä¾‹
                        const criterionWeight = criterion.weight / category.criteria.reduce((sum, c) => sum + c.weight, 0);
                        const weightedScore = score * categoryWeight * criterionWeight * 20; // è½¬æ¢ä¸º100åˆ†åˆ¶
                        
                        totalScore += weightedScore;
                        criteriaScores.push(score);
                        criteriaNames.push(criterion.name);
                    }
                    
                    // è®¡ç®—æ»¡åˆ†æƒ…å†µä¸‹çš„å¯èƒ½å¾—åˆ†
                    const maxScore = 5;
                    const maxCriterionWeight = criterion.weight / category.criteria.reduce((sum, c) => sum + c.weight, 0);
                    totalPossibleScore += maxScore * categoryWeight * maxCriterionWeight * 20;
                });
            });
            
            const weightedScore = totalPossibleScore > 0 ? Math.round(totalScore) : 0;
            document.getElementById('weighted-score').textContent = weightedScore;
            
            // æ›´æ–°é›·è¾¾å›¾
            updateRadarChart(criteriaScores, criteriaNames);
        }

        // æ›´æ–°é›·è¾¾å›¾
        function updateRadarChart(scores, names) {
            const ctx = radarChartCanvas.getContext('2d');
            ctx.clearRect(0, 0, radarChartCanvas.width, radarChartCanvas.height);
            
            // è®¾ç½®é›·è¾¾å›¾å°ºå¯¸
            const centerX = radarChartCanvas.width / 2;
            const centerY = radarChartCanvas.height / 2;
            const radius = Math.min(centerX, centerY) * 0.8;
            
            // ç»˜åˆ¶ç½‘æ ¼å’Œåˆ»åº¦
            ctx.strokeStyle = '#E2E8F0';
            ctx.lineWidth = 1;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.font = '10px Arial';
            
            // ç»˜åˆ¶5ä¸ªåŒå¿ƒåœ†
            for (let i = 1; i <= 5; i++) {
                const r = radius * i / 5;
                ctx.beginPath();
                ctx.arc(centerX, centerY, r, 0, Math.PI * 2);
                ctx.stroke();
                
                // æ·»åŠ åˆ»åº¦æ ‡ç­¾
                ctx.fillStyle = '#94A3B8';
                ctx.fillText(i, centerX, centerY - r);
            }
            
            // ç»˜åˆ¶ç»´åº¦çº¿
            const angleStep = (Math.PI * 2) / names.length;
            ctx.strokeStyle = '#CBD5E1';
            
            for (let i = 0; i < names.length; i++) {
                const angle = i * angleStep;
                const x = centerX + Math.sin(angle) * radius;
                const y = centerY - Math.cos(angle) * radius;
                
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();
                
                // æ·»åŠ ç»´åº¦æ ‡ç­¾
                ctx.fillStyle = '#475569';
                const labelX = centerX + Math.sin(angle) * (radius + 20);
                const labelY = centerY - Math.cos(angle) * (radius + 20);
                ctx.fillText(names[i], labelX, labelY);
            }
            
            // ç»˜åˆ¶æ•°æ®å¤šè¾¹å½¢
            if (scores.length > 0) {
                ctx.fillStyle = 'rgba(154, 140, 152, 0.2)';
                ctx.strokeStyle = 'rgb(154, 140, 152)';
                ctx.lineWidth = 2;
                
                ctx.beginPath();
                for (let i = 0; i < scores.length; i++) {
                    const angle = i * angleStep;
                    const r = radius * scores[i] / 5;
                    const x = centerX + Math.sin(angle) * r;
                    const y = centerY - Math.cos(angle) * r;
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.closePath();
                ctx.fill();
                ctx.stroke();
                
                // ç»˜åˆ¶æ•°æ®ç‚¹
                ctx.fillStyle = 'rgb(154, 140, 152)';
                for (let i = 0; i < scores.length; i++) {
                    const angle = i * angleStep;
                    const r = radius * scores[i] / 5;
                    const x = centerX + Math.sin(angle) * r;
                    const y = centerY - Math.cos(angle) * r;
                    
                    ctx.beginPath();
                    ctx.arc(x, y, 4, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            // æ›´æ–°å›¾ä¾‹
            updateRadarLegend(scores, names);
        }

        // æ›´æ–°é›·è¾¾å›¾å›¾ä¾‹
        function updateRadarLegend(scores, names) {
            const legendContainer = document.getElementById('radar-legend');
            legendContainer.innerHTML = '';
            
            names.forEach((name, index) => {
                const score = scores[index] || 0;
                const legendItem = document.createElement('div');
                legendItem.className = 'flex items-center';
                legendItem.innerHTML = `
                    <div class="w-3 h-3 rounded-full bg-primary mr-2"></div>
                    <span class="flex-1 truncate">${name}</span>
                    <span class="font-medium ml-2">${score}/5</span>
                `;
                legendContainer.appendChild(legendItem);
            });
        }

        // æ¸²æŸ“è‡ªæˆ‘è¯„ä¼°
        function renderSelfAssessment() {
            selfAssessmentContainer.innerHTML = '';
            
            appState.personalInfo.categories.forEach(category => {
                const categoryElement = document.createElement('div');
                categoryElement.className = 'card p-4 mb-4';
                
                let categoryHTML = `
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-medium">${category.name}</h3>
                        <span class="text-sm text-gray-500">æƒé‡: ${category.weight}%</span>
                    </div>
                    <div class="sub-criteria">
                `;
                
                category.criteria.forEach(criterion => {
                    // è·å–è¯¥æ ‡å‡†çš„è¯„åˆ†æ•°æ®
                    const selfScore = appState.personalInfo.selfAssessment.criteriaScores?.find(s => s.id === criterion.id);
                    
                    categoryHTML += `
                        <div class="criteria-item p-3 border border-gray-200 rounded-lg mb-3">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <span class="font-medium">${criterion.name}</span>
                                    <p class="text-xs text-gray-500 mt-1">${criterion.description}</p>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <select class="self-score-select text-sm border rounded p-1" data-criterion="${criterion.id}">
                                        <option value="0">æœªè¯„åˆ†</option>
                                        <option value="1" ${selfScore?.score === 1 ? 'selected' : ''}>1åˆ†</option>
                                        <option value="2" ${selfScore?.score === 2 ? 'selected' : ''}>2åˆ†</option>
                                        <option value="3" ${selfScore?.score === 3 ? 'selected' : ''}>3åˆ†</option>
                                        <option value="4" ${selfScore?.score === 4 ? 'selected' : ''}>4åˆ†</option>
                                        <option value="5" ${selfScore?.score === 5 ? 'selected' : ''}>5åˆ†</option>
                                    </select>
                                </div>
                            </div>
                            <textarea class="self-evidence-input w-full p-2 border border-gray-300 rounded-md text-sm" rows="2" 
                                      placeholder="è®°å½•å…·ä½“è¯æ®..." data-criterion="${criterion.id}">${selfScore?.evidence || ''}</textarea>
                        </div>
                    `;
                });
                
                categoryHTML += `</div>`;
                categoryElement.innerHTML = categoryHTML;
                selfAssessmentContainer.appendChild(categoryElement);
            });
            
            // æ·»åŠ è¯„åˆ†äº‹ä»¶ç›‘å¬
            document.querySelectorAll('.self-score-select').forEach(select => {
                select.addEventListener('change', updateSelfWeightedScore);
            });
            
            document.querySelectorAll('.self-evidence-input').forEach(textarea => {
                textarea.addEventListener('input', updateSelfWeightedScore);
            });
            
            // æ›´æ–°åŠ æƒåˆ†æ•°å’Œé›·è¾¾å›¾
            updateSelfWeightedScore();
        }

        // æ›´æ–°è‡ªæˆ‘è¯„ä¼°åŠ æƒåˆ†æ•°
        function updateSelfWeightedScore() {
            let totalScore = 0;
            let totalPossibleScore = 0;
            const criteriaScores = [];
            const criteriaNames = [];
            
            appState.personalInfo.categories.forEach(category => {
                const categoryWeight = category.weight / 100; // è½¬æ¢ä¸ºå°æ•°
                
                category.criteria.forEach(criterion => {
                    const scoreSelect = document.querySelector(`.self-score-select[data-criterion="${criterion.id}"]`);
                    const score = parseInt(scoreSelect.value) || 0;
                    
                    if (score > 0) {
                        // æ¯ä¸ªå°é¡¹åœ¨æ‰€å±å¤§ç±»ä¸­çš„æƒé‡æ¯”ä¾‹
                        const criterionWeight = criterion.weight / category.criteria.reduce((sum, c) => sum + c.weight, 0);
                        const weightedScore = score * categoryWeight * criterionWeight * 20; // è½¬æ¢ä¸º100åˆ†åˆ¶
                        
                        totalScore += weightedScore;
                        criteriaScores.push(score);
                        criteriaNames.push(criterion.name);
                    }
                    
                    // è®¡ç®—æ»¡åˆ†æƒ…å†µä¸‹çš„å¯èƒ½å¾—åˆ†
                    const maxScore = 5;
                    const maxCriterionWeight = criterion.weight / category.criteria.reduce((sum, c) => sum + c.weight, 0);
                    totalPossibleScore += maxScore * categoryWeight * maxCriterionWeight * 20;
                });
            });
            
            const weightedScore = totalPossibleScore > 0 ? Math.round(totalScore) : 0;
            document.getElementById('self-weighted-score').textContent = weightedScore;
            
            // æ›´æ–°é›·è¾¾å›¾
            updateSelfRadarChart(criteriaScores, criteriaNames);
        }

        // æ›´æ–°è‡ªæˆ‘è¯„ä¼°é›·è¾¾å›¾
        function updateSelfRadarChart(scores, names) {
            const ctx = selfRadarChartCanvas.getContext('2d');
            ctx.clearRect(0, 0, selfRadarChartCanvas.width, selfRadarChartCanvas.height);
            
            // è®¾ç½®é›·è¾¾å›¾å°ºå¯¸
            const centerX = selfRadarChartCanvas.width / 2;
            const centerY = selfRadarChartCanvas.height / 2;
            const radius = Math.min(centerX, centerY) * 0.8;
            
            // ç»˜åˆ¶ç½‘æ ¼å’Œåˆ»åº¦
            ctx.strokeStyle = '#E2E8F0';
            ctx.lineWidth = 1;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.font = '10px Arial';
            
            // ç»˜åˆ¶5ä¸ªåŒå¿ƒåœ†
            for (let i = 1; i <= 5; i++) {
                const r = radius * i / 5;
                ctx.beginPath();
                ctx.arc(centerX, centerY, r, 0, Math.PI * 2);
                ctx.stroke();
                
                // æ·»åŠ åˆ»åº¦æ ‡ç­¾
                ctx.fillStyle = '#94A3B8';
                ctx.fillText(i, centerX, centerY - r);
            }
            
            // ç»˜åˆ¶ç»´åº¦çº¿
            const angleStep = (Math.PI * 2) / names.length;
            ctx.strokeStyle = '#CBD5E1';
            
            for (let i = 0; i < names.length; i++) {
                const angle = i * angleStep;
                const x = centerX + Math.sin(angle) * radius;
                const y = centerY - Math.cos(angle) * radius;
                
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();
                
                // æ·»åŠ ç»´åº¦æ ‡ç­¾
                ctx.fillStyle = '#475569';
                const labelX = centerX + Math.sin(angle) * (radius + 20);
                const labelY = centerY - Math.cos(angle) * (radius + 20);
                ctx.fillText(names[i], labelX, labelY);
            }
            
            // ç»˜åˆ¶æ•°æ®å¤šè¾¹å½¢
            if (scores.length > 0) {
                ctx.fillStyle = 'rgba(201, 173, 167, 0.2)';
                ctx.strokeStyle = 'rgb(201, 173, 167)';
                ctx.lineWidth = 2;
                
                ctx.beginPath();
                for (let i = 0; i < scores.length; i++) {
                    const angle = i * angleStep;
                    const r = radius * scores[i] / 5;
                    const x = centerX + Math.sin(angle) * r;
                    const y = centerY - Math.cos(angle) * r;
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.closePath();
                ctx.fill();
                ctx.stroke();
                
                // ç»˜åˆ¶æ•°æ®ç‚¹
                ctx.fillStyle = 'rgb(201, 173, 167)';
                for (let i = 0; i < scores.length; i++) {
                    const angle = i * angleStep;
                    const r = radius * scores[i] / 5;
                    const x = centerX + Math.sin(angle) * r;
                    const y = centerY - Math.cos(angle) * r;
                    
                    ctx.beginPath();
                    ctx.arc(x, y, 4, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            // æ›´æ–°å›¾ä¾‹
            updateSelfRadarLegend(scores, names);
        }

        // æ›´æ–°è‡ªæˆ‘è¯„ä¼°é›·è¾¾å›¾å›¾ä¾‹
        function updateSelfRadarLegend(scores, names) {
            const legendContainer = document.getElementById('self-radar-legend');
            legendContainer.innerHTML = '';
            
            names.forEach((name, index) => {
                const score = scores[index] || 0;
                const legendItem = document.createElement('div');
                legendItem.className = 'flex items-center';
                legendItem.innerHTML = `
                    <div class="w-3 h-3 rounded-full bg-secondary mr-2"></div>
                    <span class="flex-1 truncate">${name}</span>
                    <span class="font-medium ml-2">${score}/5</span>
                `;
                legendContainer.appendChild(legendItem);
            });
        }

        // æ¸²æŸ“ä¸ªäººè¯„ä¼°æ ‡å‡†
        function renderPersonalCategories() {
            personalCriteriaContainer.innerHTML = '';
            
            appState.personalInfo.categories.forEach((category, categoryIndex) => {
                const categoryElement = document.createElement('div');
                categoryElement.className = 'card p-4 mb-4';
                categoryElement.setAttribute('data-category-index', categoryIndex);
                
                let categoryHTML = `
                    <div class="flex justify-between items-center mb-3">
                        <div class="flex items-center">
                            <h3 class="font-medium mr-2">${category.name}</h3>
                            <span class="text-xs bg-primary text-white px-2 py-1 rounded">æƒé‡: ${category.weight}%</span>
                        </div>
                        <div class="flex space-x-2">
                            <button class="add-subcriterion-btn text-sm text-primary" data-category-index="${categoryIndex}">
                                <i class="fas fa-plus mr-1"></i> æ·»åŠ å°é¡¹
                            </button>
                            <button class="delete-category text-danger" data-category-index="${categoryIndex}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="sub-criteria">
                `;
                
                category.criteria.forEach((criterion, criterionIndex) => {
                    categoryHTML += `
                        <div class="flex justify-between items-center p-3 border border-gray-200 rounded-lg mb-2">
                            <div>
                                <span class="font-medium">${criterion.name}</span>
                                <p class="text-xs text-gray-500">${criterion.description}</p>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="text-xs text-gray-500">æƒé‡: ${criterion.weight}</span>
                                <button class="delete-criterion text-danger" data-category-index="${categoryIndex}" data-criterion-index="${criterionIndex}">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                categoryHTML += `</div>`;
                categoryElement.innerHTML = categoryHTML;
                personalCriteriaContainer.appendChild(categoryElement);
            });
            
            // æ·»åŠ åˆ é™¤äº‹ä»¶
            document.querySelectorAll('.delete-category').forEach(button => {
                button.addEventListener('click', function() {
                    const categoryIndex = parseInt(this.getAttribute('data-category-index'));
                    appState.personalInfo.categories.splice(categoryIndex, 1);
                    saveData();
                    renderPersonalCategories();
                    renderSelfAssessment();
                });
            });
            
            // æ·»åŠ å°é¡¹äº‹ä»¶
            document.querySelectorAll('.add-subcriterion-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const categoryIndex = parseInt(this.getAttribute('data-category-index'));
                    const name = prompt('è¯·è¾“å…¥å°é¡¹åç§°:');
                    if (name) {
                        const description = prompt('è¯·è¾“å…¥å°é¡¹æè¿°:');
                        appState.personalInfo.categories[categoryIndex].criteria.push({
                            id: 'sub-' + Date.now(),
                            name,
                            description: description || '',
                            weight: 5
                        });
                        saveData();
                        renderPersonalCategories();
                        renderSelfAssessment();
                    }
                });
            });
            
            // åˆ é™¤å°é¡¹äº‹ä»¶
            document.querySelectorAll('.delete-criterion').forEach(button => {
                button.addEventListener('click', function() {
                    const categoryIndex = parseInt(this.getAttribute('data-category-index'));
                    const criterionIndex = parseInt(this.getAttribute('data-criterion-index'));
                    appState.personalInfo.categories[categoryIndex].criteria.splice(criterionIndex, 1);
                    saveData();
                    renderPersonalCategories();
                    renderSelfAssessment();
                });
            });
        }

        // æ¸²æŸ“ä¸ªäººåŸåˆ™
        function renderPersonalPrinciples() {
            renderPrinciplesList('red-lines', appState.personalInfo.redLines, 'danger');
            renderPrinciplesList('relationship-guidelines', appState.personalInfo.guidelines, 'accent');
            renderPrinciplesList('non-negotiables', appState.personalInfo.nonNegotiables, 'success');
        }

        // æ¸²æŸ“åŸåˆ™åˆ—è¡¨
        function renderPrinciplesList(containerId, items, color) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            items.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'flex items-center justify-between p-2 bg-gray-50 rounded';
                itemElement.innerHTML = `
                    <span>${item}</span>
                    <button class="delete-item text-${color}-600" data-type="${containerId}" data-index="${index}">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                container.appendChild(itemElement);
            });
            
            // æ·»åŠ åˆ é™¤äº‹ä»¶
            container.querySelectorAll('.delete-item').forEach(button => {
                button.addEventListener('click', function() {
                    const type = this.getAttribute('data-type');
                    const index = parseInt(this.getAttribute('data-index'));
                    
                    if (type === 'red-lines') {
                        appState.personalInfo.redLines.splice(index, 1);
                    } else if (type === 'relationship-guidelines') {
                        appState.personalInfo.guidelines.splice(index, 1);
                    } else if (type === 'non-negotiables') {
                        appState.personalInfo.nonNegotiables.splice(index, 1);
                    }
                    
                    saveData();
                    renderPersonalPrinciples();
                });
            });
        }

        // æ‰“å¼€æŠ½å±‰
        function openDrawer() {
            drawer.classList.add('open');
        }
        
        // å…³é—­æŠ½å±‰
        function closeDrawer() {
            drawer.classList.remove('open');
            appState.currentProfile = null;
            
            // é‡ç½®è¡¨å•
            document.getElementById('basic-info-form').reset();
            document.querySelector('input[name="relationship-type"][value="long-term"]').checked = true;
            renderAssessmentCriteria();
            interactionList.innerHTML = '<p class="text-gray-500 text-center py-4">æš‚æ— äº’åŠ¨è®°å½•</p>';
        }
        
        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tabName) {
            // æ›´æ–°æ ‡ç­¾æŒ‰é’®çŠ¶æ€
            tabBtns.forEach(btn => {
                if (btn.getAttribute('data-tab') === tabName) {
                    btn.classList.add('border-primary', 'text-primary');
                    btn.classList.remove('text-gray-500');
                } else {
                    btn.classList.remove('border-primary', 'text-primary');
                    btn.classList.add('text-gray-500');
                }
            });
            
            // æ›´æ–°æ ‡ç­¾å†…å®¹
            tabContents.forEach(content => {
                if (content.id === `tab-${tabName}`) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        }
        
        // åˆ‡æ¢é¡µé¢
        function switchPage(pageName) {
            // æ›´æ–°é¡µé¢æ˜¾ç¤º
            pages.forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(`${pageName}-page`).classList.add('active');
            
            // æ›´æ–°å¯¼èˆªæ¿€æ´»çŠ¶æ€
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-page') === pageName) {
                    item.classList.add('active');
                }
            });
        }
        
        // è·å–æ—¶é—´å·®
        function getTimeAgo(date) {
            const now = new Date();
            const diffMs = now - new Date(date);
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) return 'ä»Šå¤©';
            if (diffDays === 1) return 'æ˜¨å¤©';
            if (diffDays < 7) return `${diffDays}å¤©å‰`;
            if (diffDays < 30) return `${Math.floor(diffDays / 7)}å‘¨å‰`;
            return `${Math.floor(diffDays / 30)}æœˆå‰`;
        }
        
        // æ›´æ–°ç©ºçŠ¶æ€
        function updateEmptyState() {
            if (appState.profiles.length === 0) {
                emptyState.classList.remove('hidden');
                profilesContainer.classList.add('hidden');
            } else {
                emptyState.classList.add('hidden');
                profilesContainer.classList.remove('hidden');
            }
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬
        function setupEventListeners() {
            // ä¾§è¾¹æ åˆ‡æ¢
            toggleSidebarBtn.addEventListener('click', () => {
                appContainer.classList.toggle('collapsed');
            });
            
            // å¯¼èˆªåˆ‡æ¢
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageName = this.getAttribute('data-page');
                    switchPage(pageName);
                });
            });
            
            // æ–°å»ºå¯¹è±¡æŒ‰é’®
            addProfileBtns.forEach(btn => {
                btn.addEventListener('click', openDrawer);
            });
            
            // å…³é—­æŠ½å±‰
            closeDrawerBtn.addEventListener('click', closeDrawer);
            
            // æ ‡ç­¾é¡µåˆ‡æ¢
            tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const tabName = btn.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // æ·»åŠ äº’åŠ¨è®°å½•
            addInteractionBtn.addEventListener('click', () => {
                const date = prompt('è¯·è¾“å…¥äº’åŠ¨æ—¥æœŸ (YYYY-MM-DD):', new Date().toISOString().split('T')[0]);
                const type = prompt('è¯·è¾“å…¥äº’åŠ¨ç±»å‹:');
                const importance = prompt('è¯·è¾“å…¥é‡è¦æ€§ (high/medium/low):', 'medium');
                const description = prompt('è¯·è¾“å…¥äº’åŠ¨æè¿°:');
                
                if (date && type && importance && description) {
                    const newInteraction = {
                        id: Date.now().toString(),
                        date,
                        type,
                        importance,
                        description
                    };
                    
                    if (!appState.currentProfile.interactionLogs) {
                        appState.currentProfile.interactionLogs = [];
                    }
                    
                    appState.currentProfile.interactionLogs.push(newInteraction);
                    renderInteractionLogs(appState.currentProfile.interactionLogs);
                }
            });
            
            // ä¿å­˜æ¡£æ¡ˆ
            saveProfileBtn.addEventListener('click', () => {
                // æ”¶é›†è¡¨å•æ•°æ®
                const name = document.getElementById('profile-name').value;
                const age = document.getElementById('profile-age').value;
                const occupation = document.getElementById('profile-occupation').value;
                const meetingContext = document.getElementById('profile-meeting').value;
                const contact = document.getElementById('profile-contact').value;
                const relationshipType = document.querySelector('input[name="relationship-type"]:checked').value;
                
                // æ”¶é›†è¯„ä¼°æ•°æ®
                const criteriaScores = [];
                appState.personalInfo.categories.forEach(category => {
                    category.criteria.forEach(criterion => {
                        const scoreSelect = document.querySelector(`.score-select[data-criterion="${criterion.id}"]`);
                        const evidenceInput = document.querySelector(`.evidence-input[data-criterion="${criterion.id}"]`);
                        
                        const score = parseInt(scoreSelect.value) || 0;
                        
                        if (score > 0) {
                            criteriaScores.push({
                                id: criterion.id,
                                score: score,
                                evidence: evidenceInput.value
                            });
                        }
                    });
                });
                
                // è®¡ç®—æ€»åˆ†
                const weightedScore = parseInt(document.getElementById('weighted-score').textContent);
                
                const assessment = {
                    criteriaScores: criteriaScores,
                    weightedScore: weightedScore
                };
                
                // æ”¶é›†ç»¼åˆè¯„ä¼°
                const evaluation = {
                    strengths: document.getElementById('evaluation-strengths').value.split('\n').filter(s => s.trim()),
                    weaknesses: document.getElementById('evaluation-weaknesses').value.split('\n').filter(s => s.trim()),
                    attractions: document.getElementById('evaluation-attractions').value.split('\n').filter(s => s.trim()),
                    risks: document.getElementById('evaluation-risks').value.split('\n').filter(s => s.trim())
                };
                
                // åˆ›å»ºæˆ–æ›´æ–°æ¡£æ¡ˆ
                const profileData = {
                    name,
                    age: age ? parseInt(age) : undefined,
                    occupation,
                    meetingContext,
                    contact,
                    relationshipType,
                    assessment,
                    evaluation,
                    updatedAt: new Date()
                };
                
                if (appState.currentProfile) {
                    // æ›´æ–°ç°æœ‰æ¡£æ¡ˆ
                    Object.assign(appState.currentProfile, profileData);
                } else {
                    // åˆ›å»ºæ–°æ¡£æ¡ˆ
                    profileData.id = Date.now().toString();
                    profileData.interactionLogs = [];
                    profileData.createdAt = new Date();
                    appState.profiles.push(profileData);
                }
                
                // ä¿å­˜æ•°æ®
                saveData();
                
                // æ›´æ–°UI
                renderProfiles();
                updateEmptyState();
                
                alert('æ¡£æ¡ˆå·²ä¿å­˜ï¼');
                closeDrawer();
            });
            
            // æ·»åŠ è¯„ä¼°å¤§ç±»
            addCategoryBtn.addEventListener('click', () => {
                const name = prompt('è¯·è¾“å…¥è¯„ä¼°å¤§ç±»åç§°:');
                if (name) {
                    appState.personalInfo.categories.push({
                        id: 'category-' + Date.now(),
                        name,
                        weight: 20,
                        criteria: []
                    });
                    saveData();
                    renderPersonalCategories();
                }
            });
            
            // ä¿å­˜ä¸ªäººä¿¡æ¯
            savePersonalInfoBtn.addEventListener('click', () => {
                appState.personalInfo.name = document.getElementById('personal-name').value;
                appState.personalInfo.age = document.getElementById('personal-age').value;
                appState.personalInfo.ideal = document.getElementById('personal-ideal').value;
                saveData();
                alert('ä¸ªäººä¿¡æ¯å·²ä¿å­˜ï¼');
            });
            
            // ä¿å­˜è‡ªæˆ‘è¯„ä¼°
            saveSelfAssessmentBtn.addEventListener('click', () => {
                appState.personalInfo.selfAssessment.advantages = document.getElementById('self-advantages').value;
                appState.personalInfo.selfAssessment.disadvantages = document.getElementById('self-disadvantages').value;
                
                // æ”¶é›†è‡ªæˆ‘è¯„ä¼°æ•°æ®
                const criteriaScores = [];
                appState.personalInfo.categories.forEach(category => {
                    category.criteria.forEach(criterion => {
                        const scoreSelect = document.querySelector(`.self-score-select[data-criterion="${criterion.id}"]`);
                        const evidenceInput = document.querySelector(`.self-evidence-input[data-criterion="${criterion.id}"]`);
                        
                        const score = parseInt(scoreSelect.value) || 0;
                        
                        if (score > 0) {
                            criteriaScores.push({
                                id: criterion.id,
                                score: score,
                                evidence: evidenceInput.value
                            });
                        }
                    });
                });
                
                appState.personalInfo.selfAssessment.criteriaScores = criteriaScores;
                saveData();
                alert('è‡ªæˆ‘è¯„ä¼°å·²ä¿å­˜ï¼');
            });
            
            // æ·»åŠ åŸåˆ™é¡¹ç›®
            addItemBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const type = this.getAttribute('data-type');
                    const item = prompt('è¯·è¾“å…¥å†…å®¹:');
                    if (item) {
                        if (type === 'red-line') {
                            appState.personalInfo.redLines.push(item);
                        } else if (type === 'guideline') {
                            appState.personalInfo.guidelines.push(item);
                        } else if (type === 'non-negotiable') {
                            appState.personalInfo.nonNegotiables.push(item);
                        }
                        saveData();
                        renderPersonalPrinciples();
                    }
                });
            });
            
            // æ’åºåŠŸèƒ½
            sortProfilesSelect.addEventListener('change', function() {
                appState.sortOrder = this.value;
                saveData();
                renderProfiles();
            });
        }

        // æ¸²æŸ“äº’åŠ¨æ—¥å¿—
        function renderInteractionLogs(interactions) {
            interactionList.innerHTML = '';
            
            if (interactions.length === 0) {
                interactionList.innerHTML = '<p class="text-gray-500 text-center py-4">æš‚æ— äº’åŠ¨è®°å½•</p>';
                return;
            }
            
            interactions.forEach(interaction => {
                const interactionElement = document.createElement('div');
                interactionElement.className = 'interaction-item p-3 border border-gray-200 rounded-lg';
                interactionElement.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <span class="font-medium">${interaction.type}</span>
                            <span class="ml-2 text-xs ${
                                interaction.importance === 'high' ? 'bg-danger text-white' :
                                interaction.importance === 'medium' ? 'bg-warning text-white' :
                                'bg-gray-200 text-gray-700'
                            } px-2 py-1 rounded-full">${
                                interaction.importance === 'high' ? 'é‡è¦' :
                                interaction.importance === 'medium' ? 'ä¸­ç­‰' : 'ä¸€èˆ¬'
                            }</span>
                        </div>
                        <span class="text-xs text-gray-500">${interaction.date}</span>
                    </div>
                    <p class="text-sm text-gray-600">${interaction.description}</p>
                `;
                interactionList.appendChild(interactionElement);
            });
        }

        // åˆå§‹åŒ–åº”ç”¨
        init();
    </script>
</body>
</html>